select playerP2, raceP, scoreP, scoreT, playerT2, raceT, if (scoreP > scoreT, 1, 0) as PwinT, Concat(scoreP+scoreT) as totalmatch from (select playerA as playerP2, raceA as raceP, scoreA as scoreP, scoreB as scoreT, playerB as playerT2, game_race as raceT from (select playerA as playerA, game_race as raceA, playerB as playerB, scoreA as scoreA, scoreB as scoreB from matches inner join players on matches.playerA = players.player_id and players.game_race = "P") honors inner join players on players.player_id = honors.playerB and players.game_race = "T" union select playerB as playerP2, raceB as raceP, scoreB as scoreP, scoreA as scoreT, playerA as playerT2, game_race as raceT from (select playerB as playerB, game_race as raceB, playerA as playerA, scoreA as scoreA, scoreB as scoreB from matches inner join players on matches.playerB = players.player_id and players.game_race = "P") honors inner join players on players.player_id = honors.playerA and players.game_race = "T") honors9  
